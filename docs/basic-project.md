
![The Kubebuilder Book 로고](https://book.kubebuilder.io/logos/logo-single-line.png)

# 기본 프로젝트에 포함된 내용

새 프로젝트를 스캐폴딩할 때, Kubebuilder는 몇 가지 기본 보일러플레이트를 제공합니다.

## 빌드 인프라

프로젝트 빌드를 위한 기본 인프라:

* `go.mod`: 프로젝트에 맞춘 새 Go 모듈과 기본 의존성을 정의합니다.

  ```go
  module tutorial.kubebuilder.io/project

  go 1.24.0

  require (
  	github.com/onsi/ginkgo/v2 v2.22.0
  	github.com/onsi/gomega v1.36.1
  	github.com/robfig/cron v1.2.0
  	k8s.io/api v0.33.0
  	k8s.io/apimachinery v0.33.0
  	k8s.io/client-go v0.33.0
  	sigs.k8s.io/controller-runtime v0.21.0
  )
  ```

* `Makefile`: 컨트롤러 빌드·배포를 위한 Make 타겟이 정의되어 있습니다.

  ```makefile
  # Image URL to use all building/pushing image targets
  IMG ?= controller:latest

  ifeq (,$(shell go env GOBIN))
  GOBIN=$(shell go env GOPATH)/bin
  else
  GOBIN=$(shell go env GOBIN)
  endif

  CONTAINER_TOOL ?= docker
  SHELL = /usr/bin/env bash -o pipefail
  .SHELLFLAGS = -ec

  .PHONY: all
  all: build

  ##@ General
  help: ## Display this help.
  	@awk 'BEGIN {FS = ":.*##"; printf "\nUsage:\n  make \033[36m<target>\033[0m\n"} \
  	/^[a-zA-Z_0-9-]+:.*?##/ { printf "  \033[36m%-15s\033[0m %s\n", $$1, $$2 } \
  	/^##@/ { printf "\n\033[1m%s\033[0m\n", substr($$0, 5) } ' $(MAKEFILE_LIST)

  ##@ Development
  manifests: controller-gen ## Generate WebhookConfiguration, ClusterRole and CRD artifacts.
  	$(CONTROLLER_GEN) rbac:roleName=manager-role crd:maxDescLen=0 webhook \
  	    paths="./..." output:crd:artifacts:config=config/crd/bases

  generate: controller-gen ## Generate deepcopy methods.
  	$(CONTROLLER_GEN) object:headerFile="hack/boilerplate.go.txt" paths="./..."

  fmt: ## Run go fmt.
  	go fmt ./...

  vet: ## Run go vet.
  	go vet ./...

  test: manifests generate fmt vet setup-envtest ## Run tests.
  	KUBEBUILDER_ASSETS="$(shell $(ENVTEST) use $(ENVTEST_K8S_VERSION) --bin-dir $(LOCALBIN) -p path)" \
  	    go test $$(go list ./... | grep -v /e2e) -coverprofile cover.out

  ##@ Build
  build: manifests generate fmt vet ## Build manager binary.
  	go build -o bin/manager cmd/main.go

  run: manifests generate fmt vet ## Run controller locally.
  	go run ./cmd/main.go

  docker-build: ## Build Docker image.
  	$(CONTAINER_TOOL) build -t ${IMG} .

  docker-push: ## Push Docker image.
  	$(CONTAINER_TOOL) push ${IMG}
  ```

## 프로젝트 메타데이터

Kubebuilder가 스캐폴딩에 사용한 메타데이터는 `PROJECT` 파일에 저장됩니다. **수정하지 마십시오**:

```yaml
# Code generated by tool. DO NOT EDIT.
# 이 파일은 스캐폴딩에 사용된 정보를 추적하며,
# 플러그인이 제대로 작동하도록 돕습니다.
# More info: [Project Config Reference](https://book.kubebuilder.io/reference/project-config.html)

cliVersion: (devel)
domain: tutorial.kubebuilder.io
layout:
- go.kubebuilder.io/v4
plugins:
  helm.kubebuilder.io/v1-alpha: {}
projectName: project
repo: tutorial.kubebuilder.io/project
resources:
- api:
    crdVersion: v1
    namespaced: true
  controller: true
  domain: tutorial.kubebuilder.io
  group: batch
  kind: CronJob
  path: tutorial.kubebuilder.io/project/api/v1
  version: v1
  webhooks:
    defaulting: true
    validation: true
    webhookVersion: v1
version: "3"
```

## 실행 구성

`config/` 디렉터리에는 클러스터에서 컨트롤러를 실행하기 위한 Kustomize 설정이 들어 있습니다.

* [`config/`](https://github.com/kubernetes-sigs/kubebuilder/tree/master/cronjob-tutorial/basic-project/config): 초기 YAML 정의
* [`config/default`](https://github.com/kubernetes-sigs/kubebuilder/tree/master/cronjob-tutorial/basic-project/config/default): 표준 실행을 위한 베이스

  * [`config/manager`](https://github.com/kubernetes-sigs/kubebuilder/tree/master/cronjob-tutorial/basic-project/config/manager): 컨트롤러 Pod 실행
  * [`config/rbac`](https://github.com/kubernetes-sigs/kubebuilder/tree/master/cronjob-tutorial/basic-project/config/rbac): 서비스 계정 권한 설정

## 엔트리 포인트

마지막으로, 프로젝트의 기본 **엔트리 포인트**인 `main.go`가 생성됩니다. 다음 섹션에서 자세히 살펴봅니다.
